---
title: ç±»å‹è½¬æ¢
---

# ç±»å‹è½¬æ¢

## æ˜¾å¼è½¬æ¢

* ### [ToBoolean][id] 

  > falseï¼Œundefinedï¼Œnullï¼Œ0ï¼ŒNaNï¼Œ""
  >
  > å…¶ä»–å…¨æ˜¯true
  >
  > !!

  ```js
  console.log(Boolean()) // false
  
  console.log(Boolean(false)) // false
  
  console.log(Boolean(undefined)) // false
  console.log(Boolean(null)) // false
  console.log(Boolean(+0)) // false
  console.log(Boolean(-0)) // false
  console.log(Boolean(NaN)) // false
  console.log(Boolean("")) // false
  ```

* ### [ToString][id]

  >ä½¿ç”¨`æ¨¡ç‰ˆå­—ç¬¦ä¸²`\`${undefined}\`` `å¯ä»¥å°†å…¶ä»–ç±»å‹è½¬ä¸º `string` ç±»å‹

  | å‚æ•°ç±»å‹  | ç»“æœ                                                         |
  | --------- | ------------------------------------------------------------ |
  | Undefined | "undefined"                                                  |
  | Null      | "null"                                                       |
  | Boolean   | trueï¼Œè¿”å› "true"ã€‚<br />Ë‰ falseï¼Œè¿”å› "false"               |
  | Number    | æ•°å­—(âš ï¸è¿›åˆ¶çš„è½¬æ¢)çš„å­—ç¬¦ä¸²ï¼ŒNaNï¼ŒInfinity                     |
  | String    | è¿”å›ä¸ä¹‹ç›¸ç­‰çš„å€¼                                             |
  | å¯¹è±¡      | ToPrimitive<br />â‘ è°ƒç”¨å¯¹è±¡çš„`toString()`ï¼Œå¦‚æœæ˜¯åŸå§‹å€¼ï¼Œåˆ™è¿”å›<br />â‘¡å¦åˆ™è°ƒç”¨å¯¹è±¡çš„`valueOf()`,å¦‚æœæ˜¯åŸå§‹å€¼ï¼Œåˆ™è¿”å›<br />â‘¢å¦åˆ™æŠ¥ç±»å‹é”™è¯¯çš„å¼‚å¸¸ |

  ```js
  console.log(String()) // ç©ºå­—ç¬¦ä¸²
  
  console.log(String(undefined)) // undefined
  console.log(String(null)) // null
  
  console.log(String(false)) // false
  console.log(String(true)) // true
  
  console.log(String(0)) // 0
  console.log(String(-0)) // 0
  console.log(String(NaN)) // NaN
  console.log(String(Infinity)) // Infinity
  console.log(String(-Infinity)) // -Infinity
  console.log(String(1)) // 1
  
  ```

* ### [ToNumber][id]

  > NaNï¼Œ0ï¼Œ1ï¼Œå…·ä½“æ•°å­—
  >
  > ä½¿ç”¨`+`å¯ä»¥å°†å…¶ä»–ç±»å‹è½¬ä¸º `number` ç±»å‹

  | å‚æ•°ç±»å‹  | ç»“æœ                                                         |
  | --------- | ------------------------------------------------------------ |
  | Undefined | NaN                                                          |
  | Null      | +0                                                           |
  | Boolean   | trueï¼Œè¿”å› 1ã€‚<br /> falseï¼Œè¿”å› +0                          |
  | Number    | è¿”å›ä¸ä¹‹ç›¸ç­‰çš„å€¼                                             |
  | String    | â‘ ä¸€ä¸ªæ•´æ•°æˆ–æµ®ç‚¹æ•°ï¼Œè€Œä¸”ä¼šå¿½ç•¥æ‰€æœ‰å‰å¯¼çš„ 0 <br />â‘¡æœ‰ä¸€ä¸ªå­—ç¬¦ä¸æ˜¯æ•°å­—ï¼Œç»“æœéƒ½ä¼šè¿”å› NaN |
  | å¯¹è±¡      | ToPrimitive<br />â‘ è°ƒç”¨å¯¹è±¡çš„`valueOf()`ï¼Œå¦‚æœæ˜¯åŸå§‹å€¼ï¼Œåˆ™è¿”å›<br />â‘¡å¦åˆ™è°ƒç”¨å¯¹è±¡çš„`toString()`,å¦‚æœæ˜¯åŸå§‹å€¼ï¼Œåˆ™è¿”å›<br />â‘¢å¦åˆ™æŠ¥ç±»å‹é”™è¯¯çš„å¼‚å¸¸ |

  ```js
  console.log(Number()) // +0
  
  console.log(Number(undefined)) // NaN
  console.log(Number(null)) // +0
  
  console.log(Number(false)) // +0
  console.log(Number(true)) // 1
  
  console.log(Number("123")) // 123
  console.log(Number("-123")) // -123
  console.log(Number("1.2")) // 1.2
  console.log(Number("000123")) // 123
  console.log(Number("-000123")) // -123
  
  console.log(Number("0x11")) // 17
  
  console.log(Number("")) // 0
  console.log(Number(" ")) // 0
  
  console.log(Number("123 123")) // NaN
  console.log(Number("foo")) // NaN
  console.log(Number("100a")) // NaN
  ```

  ```js
  //å¯¹è±¡ -> Number    
  console.log(Number({})) // NaN
  console.log(Number({a : 1})) // NaN
  
  console.log(Number([])) // 0   "" ==>0
  console.log(Number([0])) // 0  "0" ==> 0
  console.log(Number([1, 2, 3])) // NaN   "1,2,3"==>NaN
  console.log(Number(function(){var a = 1;})) // NaN   "func......"==>NaN
  console.log(Number(/\d+/g)) // NaN "/\d+/g"==>NaN
  console.log(Number(new Date(2010, 0, 1))) // 1262275200000   valueOf
  console.log(Number(new Error('a'))) // NaN   "Error: a"==>NaN
  
  ```

  > {}.valueOf() ->{}  ====>{}.toString()-->"[object Object]"
  >
  > æ­¤æ—¶ç›¸å½“äº"[object Object]" è½¬æ•°å­—

## éšå¼è½¬æ¢

* ### [ä¸€å…ƒæ“ä½œç¬¦ +][id]ã€‚ä¸Šè¿°ï¼ˆğŸ‘†[ToNumber](#ToNumber)ï¼‰

  ```js
  console.log(+[]); // 0
  console.log(+['1']); // 1
  console.log(+['1', '2', '3']); // NaN
  console.log(+{}); // NaN
  ```

  

* ### [äºŒå…ƒæ“ä½œç¬¦ + ][id]

  å½“è®¡ç®— value1 + value2æ—¶ï¼š

  1. lprim = ToPrimitive(value1)
  2. rprim = ToPrimitive(value2)
  3. å¦‚æœ lprim æ˜¯å­—ç¬¦ä¸²æˆ–è€… rprim æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆè¿”å› ToString(lprim) å’Œ ToString(rprim)çš„æ‹¼æ¥ç»“æœ
  4. è¿”å› ToNumber(lprim) å’Œ ToNumber(rprim)çš„è¿ç®—ç»“æœ

  ```js
  console.log(1 +'1')        // 11
  console.log('abc' + 1)     // abc1
  console.log(null + 1)      //1
  console.log([] + [])       //""
  console.log([] + {})       //"[object Object]"
  console.log({} + {});      //"[object Object][object Object]"
  console.log(1 + true);     // 2
  console.log(new Date(2017, 04, 21) + 1) // "Sun May 21 2017 00:00:00 GMT+0800 (CST)1"
  ```

* ### [== ç›¸ç­‰ ][id]

  å½“æ‰§è¡Œx == y æ—¶ï¼š

  1. å¦‚æœxä¸yæ˜¯åŒä¸€ç±»å‹ï¼š
     1. xæ˜¯Undefinedï¼Œè¿”å›true    ` console.log(undefined == undefined) //true`
     2. xæ˜¯Nullï¼Œè¿”å›true.             `console.log(null == null)//true`
     3. xæ˜¯æ•°å­—ï¼š
        1. xæ˜¯NaNï¼Œè¿”å›false.     `console.log(NaN == 3) //false`
        2. yæ˜¯NaNï¼Œè¿”å›false.     `console.log(NaN == NaN) //false`
        3. xä¸yç›¸ç­‰ï¼Œè¿”å›true
        4. xæ˜¯+0ï¼Œyæ˜¯-0ï¼Œè¿”å›true
        5. xæ˜¯-0ï¼Œyæ˜¯+0ï¼Œè¿”å›true
        6. è¿”å›false
     4. xæ˜¯å­—ç¬¦ä¸²ï¼Œå®Œå…¨ç›¸ç­‰è¿”å›true,å¦åˆ™è¿”å›false
     5. xæ˜¯å¸ƒå°”å€¼ï¼Œxå’Œyéƒ½æ˜¯trueæˆ–è€…falseï¼Œè¿”å›trueï¼Œå¦åˆ™è¿”å›false
     6. xå’ŒyæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œè¿”å›trueï¼Œå¦åˆ™è¿”å›false
  2. xæ˜¯nullå¹¶ä¸”yæ˜¯undefinedï¼Œè¿”å›true. ï¼ˆåä¹‹ï¼Œtrueï¼‰  `console.log(null == undefined) //true`
  3. `æ•°å­—å’Œå­—ç¬¦ä¸²æ—¶ï¼ŒToNumber(å­—ç¬¦ä¸²)`
  4. `å­˜åœ¨å¸ƒå°”å€¼æ—¶ï¼ŒToNumber(å¸ƒå°”å€¼)`
  5. `xæ˜¯å¯¹è±¡ï¼Œyä¸æ˜¯å­—ç¬¦ä¸²æˆ–è€…æ•°å­—ï¼ŒToPrimitive(å¯¹è±¡) `
  6. è¿”å›false

## ç»ƒä¹ 

### 1ã€`[] == ![]`

```js
console.log([] == ![])//true
```

> ä¼˜å…ˆè®¡ç®— ![]  ä¹Ÿå°±æ˜¯ [] è½¬æ¢æˆbooleanï¼ˆä¸Šè¿°ToBooleanï¼‰ã€‚` []->true.  ![]->false`
> æ­¤æ—¶åˆ¤æ–­` [] == false `
> èµ°[ğŸ‘†==ç›¸ç­‰](#== ç›¸ç­‰)çš„ç¬¬5æ¡ï¼Œ`ToPrimitive([]) --> [].valueOf() --> [] --> [].toString()-->""`
>æ­¤æ—¶åˆ¤æ–­ `"" == false`
>
>èµ°[ğŸ‘†==ç›¸ç­‰](#== ç›¸ç­‰)çš„ç¬¬3ï¼Œ4æ¡ï¼Œ0 == 0

### 2ã€`[]["map"]+[]`

```js
[]['push'](1) // 1 
[]["map"] //function map() { [native code] }
[]["map"]+[] // "function map() { [native code] }"
```

>* `[]['push'](1) ` ç›¸å½“äº `[].push(1)` push è¿”å›æ•°ç»„é•¿åº¦
>
>* `[]['map']` ç›¸å½“äº `[].map`mapæ–¹æ³• 
>
>  * è‹¥`[]['map']()`ç›¸å½“äºæ‰§è¡Œmapæ–¹æ³•ï¼Œmapå†…æœªä¼ æ–¹æ³•ï¼ŒæŠ¥é”™
>
>* `[]["map"]+[]` [ğŸ‘†äºŒå…ƒæ“ä½œç¬¦ +](#äºŒå…ƒæ“ä½œç¬¦ +)
>
>  * `[]["map"].valueOf()-->function map...--> `
>
>    `[]["map"].toString()-->"function map() { [native code] }"`
>
>  * `[].valueOf()-->[]-->[].toString()-->""`
>
>  * ç›¸å½“äº`"function map() { [native code] }" + ""`

### 3ã€(a==1 && a==2 && a==3) èƒ½ä¸èƒ½ä¸ºtrue

```js
//æ–¹æ³•ä¸€  valueOf/toString/[Symbol.toPrimitive] éƒ½å¯
var a = {
  num: 0,
  valueOf: function() {
    return this.num += 1
  }
};
console.log(a==1 && a==2 && a==3);

//[Symbol.toPrimitive]
var a = {[Symbol.toPrimitive]: ((i) => () => ++i) (0)}
console.log(a==1 && a==2 && a==3);

```

>æ³¨æ„ï¼š
>
>â‘ å¯¹è±¡éšå¼è½¬æ¢æˆåŸºæœ¬ç±»å‹æ—¶ï¼Œå¦‚æœ `Symbol.toPrimitive` å’Œ `toString` æˆ–è€… `valueOf` åŒæ—¶å­˜åœ¨æ—¶ ä¼šä¼˜å…ˆè°ƒç”¨ `Symbol.toPrimitive`
>â‘¡å¦‚æœ `Symbol.toPrimitive` ä¸å­˜åœ¨æ—¶ ä¼šå…ˆè°ƒç”¨ `valueOf`ï¼Œå¦‚æœ`valueOf`çš„è¿”å›å€¼è¿˜æ˜¯ä¸€ä¸ªå¯¹è±¡æ—¶ï¼ˆé»˜è®¤æƒ…å†µ ä¼šè¿”å›å¯¹è±¡æœ¬èº«ï¼‰
>
>â‘¢åˆ™å†è°ƒç”¨`toString`ï¼Œå¦‚æœ`toString` è¿”å›å€¼è¿˜æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆäººä¸ºå®šä¹‰è¦†ç›–ï¼Œé»˜è®¤ä¼šè¿”å›[object Object]ï¼‰ åˆ™æŠ›å‡ºé”™è¯¯

```js
//æ–¹æ³•äºŒ  æ‹¦æˆª defineProperty/Proxy
let val = 0;
Object.defineProperty(window, 'a', { 
      get: function() {    
        return ++val;  
      }
});
console.log(a==1 && a==2 && a==3);
//
const a = new Proxy({}, {
  v: 1,
  get: function ()  {
    return () => this.v++;
  }
});
console.log(a==1 && a==2 && a==3);
```



```js
//æ–¹æ³•ä¸‰ åŸå‹ä¸Šä¿®æ”¹  Number/String
var i = 1
Number.prototype.valueOf = function() {
    return i++
}
var a = new Number()
console.log(a==1 && a==2 && a==3);
```



```js
//æ•°ç»„ 
// â‘ 
var a = [1,2,3];
a[Symbol.toPrimitive] = function(){return this.shift()};
//â‘¡
var a = [1,2,3];
a.join = a.shift;
console.log(a==1 && a==2 && a==3);
```

>â‘¡
>
> a  ä¸ºæ•°ç»„ï¼Œ`[1,2,3].valueOf()-->[1,2,3]--> [1,2,3].toString()--> "1,2,3"`
>
>aéšå¼è½¬æ¢ä¼šè°ƒç”¨toStringæ–¹æ³• è€ŒtoStringæ–¹æ³•å†…éƒ¨ä¼šè°ƒç”¨ joinæ–¹æ³•
>
>a.join = a.shift;  é€šè¿‡æ”¹å˜joinæ–¹æ³•ï¼Œæ¥æ”¹å˜å€¼

### 4ã€

```js
![] 
 +[] 
 +![] 
[]+[] 
{}+{}
{}+[]
{a:0}+1 
[]+{}
[]+![]
{}+[]
![]+[]
''+{} 
{}+'' 
[]["map"]+[] 
[]["a"]+[]
[][[]] + []
+!![]+[] 
+!![] 
1-{} 
1-[] 
true-1 
{}-1 
[]==![] 
```



ç­”æ¡ˆå¦‚ä¸‹ğŸ‘‡

```js
![] //false;
 +[]  // 0
 +![]  // 0
[]+[] // ""
{}+{}//"[object Object][object Object]"
{}+[]//0
{a:0}+1 // 1
[]+{}//"[object Object]"
[]+![]//"false"
{}+[]//0
![]+[] // "false"
''+{} //"[object Object]"
{}+'' //0
[]["map"]+[] //"function map() { }"
[]["a"]+[] // "undefined"
[][[]] + []// "undefined"
+!![]+[] //"1"
+!![] //1
1-{} //NaN
1-[] //1
true-1 //0
{}-1 //-1
[]==![] //true
```



## è¿ç®—ç¬¦

[ç¬¦å·ä¼˜å…ˆçº§](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Operator_Precedence#Table)

è®°å‡ ä¸ªï¼Œä»å³å‘å·¦çš„ â¬…ï¸

* ä¸‰å…ƒè¿ç®—ç¬¦  `...ï¼Ÿ...ï¼š...`
* èµ‹å€¼ ` = ã€%=ã€+=ã€-=ã€*=...`
* å¹‚ `**`





å‚è€ƒé“¾æ¥

* [JavaScript æ·±å…¥ä¹‹å¤´ç–¼çš„ç±»å‹è½¬æ¢(ä¸Š)](https://github.com/mqyqingfeng/Blog/issues/159#)

* [JavaScriptæ·±å…¥ä¹‹å¤´ç–¼çš„ç±»å‹è½¬æ¢(ä¸‹)](https://github.com/mqyqingfeng/Blog/issues/164#)
* [JavaScript ä¸“é¢˜ä¹‹èŠ±å¼è¡¨ç¤º 26 ä¸ªå­—æ¯](https://github.com/mqyqingfeng/Blog/issues/166)
* [ã€è¯‘ã€‘ (a ==1 && a== 2 && a==3) æœ‰å¯èƒ½æ˜¯ true å—ï¼Ÿ](https://juejin.im/entry/5a683a846fb9a01cbd58c3ef)
* [å¦‚ä½•è®© (a == 1 && a == 2 && a == 3) çš„å€¼ä¸ºtrue](https://github.com/YvetteLau/Step-By-Step/issues/9)
* [ç©è½¬jsç±»å‹è½¬æ¢](https://imweb.io/topic/5be2f05a21ff0e9610a6646e)
* [ç¬¦å·ä¼˜å…ˆçº§](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Operator_Precedence#Table)

